# test FCVAB with Robin border condition #
# AUTHOR : KRAEMER VALENTIN #
# LAST MODIFICATION : 31/7/24 #
# PARALLEL OK  #

Dimension 2
Pb_hydraulique pb

Domaine dom

# BEGIN MESH #
Mailler dom
{
	Pave Cavite
	{
		Origine 0.1 0.1
		Nombre_de_noeuds 4 4	
		Longueurs 1 1
		}
		{
			Bord bas      Y =  0.1  0.1 <= X <= 1.1
			Bord droit    X =  1.1  0.1 <= Y <= 1.1
			Bord haut     Y =  1.1  0.1 <= X <= 1.1
			Bord gauche   X =  0.1  0.1 <= Y <= 1.1
		}
}

Trianguler_H dom
# END MESH #

# BEGIN PARTITION
Partition dom
{
    Partition_tool metis { Nb_parts 4 }
    Larg_joint 2
    zones_name DOM
}
End
END PARTITION #

# BEGIN SCATTER
Scatter DOM.Zones dom
END SCATTER #

VEFPreP1b dis Read dis { P0 }
# Lire dis { P0 } #

Schema_Euler_implicite sch
Lire sch
{
	tinit 0
	nb_pas_dt_max 3
	dt_min 1e-6
	dt_max 1e-3
	dt_impr 1e1
	facsec 1
	facsec_max 1
	solveur implicite { solveur gmres { diag nb_it_max 3 seuil 1e-12 impr } }
	precision_impr 8
	seuil_statio 1e-6
}


Associer pb dom
Associer pb sch

Discretiser pb dis

Lire pb
{
   
   fluide_incompressible {
    	mu champ_uniforme 1 1
    	rho champ_uniforme 1 1
   }
   
   	Navier_Stokes_standard
	{
		projection_initiale	0
		methode_calcul_pression_initiale	sans_rien
		Solveur_pression	PETSC Cholesky { }
		Convection		{ negligeable }
		Diffusion		{ }
		Conditions_initiales	{
					vitesse champ_fonc_xyz dom 2 0 0
					pression champ_uniforme 1 0.01
					}
		Conditions_limites	{
					gauche		frontiere_ouverte_vitesse_imposee champ_front_fonc_xyz 2 0 0
					droit		frontiere_ouverte_vitesse_imposee champ_front_fonc_xyz 2 0 0
			bas		frontiere_ouverte_vitesse_imposee champ_front_fonc_xyz 2 0 0
					haut	Robin_VEF {
         alpha 25
         beta 10
         champ_front_normal_et_tangentiel_robin champ_front_fonc_xyz 2 -0.25 0        
}
					}

		Sources			{
					Source_Qdm champ_fonc_xyz dom 2 0 0
					}
	}
	Postraitement 
	{	
		Definition_champs
		{
			pressure_max    reduction_0D    {
						methode max
						source interpolation    {
						    localisation ELEM
						    source refChamp { Pb_champ pb pression }
						}
					    }
			 pressure_min    reduction_0D    {
				methode min
				source interpolation    {
				    localisation ELEM
				    source refChamp { Pb_champ pb pression }
				}
			    }
			    
			velocity_max    reduction_0D    {
						methode max
						source interpolation    {
						    localisation FACES
						    source refChamp { Pb_champ pb vitesse }
						}
					    }
			 velocity_min    reduction_0D    {
				methode min
				source interpolation    {
				    localisation FACES
				    source refChamp { Pb_champ pb vitesse }
				}
			    }
		}
		
		Probes 
		{
			pressure_max pressure_max Periode 0.5 Point 1 0.5 0.5
			pressure_min pressure_min Periode 0.5 Point 1 0.5 0.5
			velocity_max velocity_max Periode 0.5 Point 1 0.5 0.5
			velocity_min velocity_min Periode 0.5 Point 1 0.5 0.5
		}

		Format lml
		fields dt_post 1.3
		{
			pression elem
			vitesse elem
		}
	}
}

Resoudre pb
Fin
 
